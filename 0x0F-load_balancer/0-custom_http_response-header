#!/usr/bin/env bash
# Installs Nginx with the following configurations:
#+    Listens on port 80.
#+    Returns a page containing "Holberton School" when queried
#+     at the root with a curl GET request.
#+    Configures /redirect_me as a "301 Moved Permanently".
#+    Includes a custom 404 page containing "Ceci n'est pas une page".
#+    Contains a custom HTTP header named X-Served-By.
#+    The value of the HTTP header is the hostname of the running server.

#!/bin/bash

# Update the package repository and install Nginx
sudo apt-get update
sudo apt-get install -y nginx

# Define the hostname based on the machine's hostname
hostname=$(hostname)

# Create a custom Nginx configuration file
cat <<EOF | sudo tee /etc/nginx/conf.d/0-custom-http-header.conf
server {
    listen 80;
    server_name _;

    # Add the custom X-Served-By header
    location / {
        add_header X-Served-By $hostname;
        proxy_pass http://backend;
    }

    # Include additional Nginx configuration files
    include /etc/nginx/sites-enabled/*;
}
EOF

# Remove the default configuration symlink
sudo rm -f /etc/nginx/sites-enabled/default

# Restart Nginx to apply the changes
sudo service nginx restart

